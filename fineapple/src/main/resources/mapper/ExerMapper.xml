<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.fineapple.mapper.ExerMapper">

	<resultMap id="UserServiceMap" type="ExerService">
		<result property="dailyTrgtBurnningKcal" 			column="DAILY_TRGT_BURNNING_KCAL" 	jdbcType="FLOAT"/>
		<result property="trgtBodyMuscle"	column="TRGT_BODY_MUSCLE" 		jdbcType="FLOAT" />	
		<result property="exerServiceTrgt" 	column="SERVICE_TRGT" 		jdbcType="VARCHAR" />
		<result property="userId" 	column="USER_ID" 		jdbcType="VARCHAR" />	
		<result property="bodyMuscle" 				column="BODY_MUSCLE" 	jdbcType="FLOAT" />	
	</resultMap>
	
	
	
	<resultMap id="BurnningRecordMap" type="BurnningRecord">
		<result property="exer.exerNo" 			column="EXER_NO" 			jdbcType="INTEGER"/>
		<result property="burnningRecordDate"	column="BURNNING_RECORD_DATE" 		jdbcType="DATE" />	
		<result property="exerLv" 	column="EXER_LV" 		jdbcType="INTEGER" />
		<result property="anExerTime" 				column="AN_EXER_TIME" 	  jdbcType="TIMESTAMP" />
		<result property="userExerBurnning" 				column="USER_EXER_BURNNING" 	jdbcType="FLOAT" />
	</resultMap>



	<resultMap id="exerMap" type="Exer">
		<result property="exerCate"	column="EXER_CATE" 		jdbcType="VARCHAR" />
		<result property="exerLv" 	column="EXER_LV" 		jdbcType="INTEGER" />
		<result property="exerName" 				column="EXER_NAME" 					jdbcType="VARCHAR" />
		<result property="exerKcal" 				column="EXER_KCAL" 					jdbcType="FLOAT" />
		<result property="exerVideoName" 				column="EXER_VIDEO_NAME" 					jdbcType="INTEGER" />
		<result property="exerVideoTime" 				column="EXER_VIDEO_TIME" 					jdbcType="TIMESTAMP" />	
	</resultMap>


	<resultMap id="routineInfoMap" type="Routine">
		<result property="routine.routineNo" 			column="ROUTINE_NO" 			jdbcType="INTEGER"/>
		<result property="exer.exerNo"	column="EXER_NO" 		jdbcType="INTEGER" />
		<result property="anExerTime" 	column="AN_EXER_TIME" 		jdbcType="TIMESTAMP" />
		<result property="totalExerSetCount" 				column="TOTAL_EXER_SET_COUNT" 					jdbcType="INTEGER" />
		<result property="aSetTime" 				column="A_SET_TIME" 					jdbcType="TIMESTAMP" />
		<result property="restTime" 				column="REST_TIME" 					jdbcType="TIMESTAMP" />
		<collection property="routine" column="ROUTINE_NO" javaType="java.util.ArrayList">
      </collection>
	</resultMap> 
	
     <!--  <resultMap id ="FavMealMap" type="FavMeal">
      <result property="favMealNo"             column="FOOD_NO"       jdbcType="INTEGER"/>
      <result property="favMealName"    column="USER_ID"       jdbcType="VARCHAR"/>
      <result property="favMealKcal"             column="MEAL"       jdbcType="VARCHAR"/>
      <collection property="food" column="FOOD_NO" javaType="java.util.ArrayList">
      </collection>
      </resultMap>
       -->
      
	<resultMap id="routineMap" type="Routine">
		<result property="routineName" 	column="ROUTINE_NAME" 		jdbcType="VARCHAR" />
		<result property="routineTime" 				column="ROUTINE_TIME" 					jdbcType="TIMESTAMP" />
		<result property="routineKcal" 				column="ROUTINE_KCAL" 					jdbcType="FLOAT" />
	</resultMap>


	<insert id="addUserService" parameterType="ExerService">
	INSERT INTO  USER_SERVICE (USER_SERVICE_NO, USER_ID, DAILY_TRGT_BURNNING_KCAL, TRGT_BODY_MUSCLE) 
	VALUES (7,
			#{userId:VARCHAR},
			#{dailyTrgtBurnningKcal:FLOAT},
			#{trgtBodyMuscle:FLOAT}
			)
	
	</insert>
	
	<insert id="addDailyBurnning" parameterType="BurnningRecord">
	INSERT INTO BURNNING_RECORD (BURNNING_RECORD_NO, USER_SERVICE_NO, EXER_NO, BURNNING_RECORD_DATE, EXER_LV, AN_EXER_TIME, USER_EXER_BURNNING) 
	VALUES (15,
			(SELECT user_service_no from user_service where user_id =#{userId:VARCHAR}),
			#{exer.exerNo:INTEGER},
			SYSDATE,
			#{exerLv:INTEGER},
			#{anExerTime:TIMESTAMP},
			#{userExerBurnning:FLOAT}
			)
	
	</insert>
	
	
	<insert id="updateUsers" parameterType="User">
	INSERT INTO BURNNING_RECORD (BURNNING_RECORD_NO, USER_SERVICE_NO, EXER_NO, BURNNING_RECORD_DATE, EXER_LV, AN_EXER_TIME, USER_EXER_BURNNING) 
	VALUES (8,
			(SELECT user_service_no from user_service where user_id = #{userId:VARCHAR}),
			#{exer.exerNo:INTEGER},
			SYSDATE,
			#{exerLv:INTEGER},
			#{anExerTime:TIMESTAMP},
			#{userExerBurnning:FLOAT}
			)
	
	</insert>
	
	
	
	
   <update id="updateServiceTrgt" parameterType="ExerService">
   UPDATE USERS 
   SET SERVICE_TRGT = #{exerServiceTrgt:VARCHAR}
   WHERE USER_ID = #{userId:VARCHAR}
   </update>
	
	
	
	<update id="updateBodyInfo" parameterType="ExerService">
   UPDATE USER_BODY_INFO
   SET BODY_MUSCLE = #{bodyMuscle:FLOAT}
   WHERE USER_ID = #{userId:VARCHAR}
   	</update>
	
	
	<update id="updateExerService" parameterType="BurnningRecord">
	
	UPDATE BURNNING_RECORD
    SET (5,
       (SELECT user_service_no from user_service where user_id = #{userId:VARCHAR}),
   			exer_no= #{exer.exerNo:INTEGER},
			BURNNING_RECORD_DATE= SYSDATE,
			exer_lv= #{exerLv:INTEGER},
			an_exer_time = #{anExerTime:INTEGER},
			user_burnning_record = #{userExerBurnning:FLOAT)
	
	</update>
	
	
	<select	id="getExerService"	 parameterType="BurnningRecord">
			SELECT *
			FROM BURNNING_RECORD
			WHERE user_service_no=
			(SELECT user_service_no from user_service where user_id ='hc@gmail.com')
			</select>
	

</mapper>